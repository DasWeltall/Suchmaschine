<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Webcrawler-Demo</title>
</head>
<body>
  <h1>Webcrawler-Demo</h1>

  <form action="/" method="GET">
    <label for="search-input">Suchbegriff eingeben:</label>
    <input type="text" id="search-input" name="q" placeholder="Suchbegriff eingeben">
    <button type="submit">Suchen</button>
  </form>

  <ul id="results"></ul>

  <script src="https://unpkg.com/puppeteer"></script>

  <script>
    const resultsElement = document.getElementById("results");

    // Funktion zum Anzeigen der Crawler-Ergebnisse
    function showResults(title, links) {
      // Leeren der Ergebnisliste
      resultsElement.innerHTML = "";

      // Titel hinzufügen
      const titleElement = document.createElement("h2");
      titleElement.textContent = title;
      resultsElement.appendChild(titleElement);

      // Links als Liste hinzufügen
      for (const link of links) {
        const linkElement = document.createElement("li");
        const anchorElement = document.createElement("a");
        anchorElement.href = `https://www.example.com/${link}`;
        anchorElement.textContent = link;
        linkElement.appendChild(anchorElement);
        resultsElement.appendChild(linkElement);
      }
    }

    // Suchfunktion
    async function search() {
      // Suchbegriff aus der Eingabe abrufen
      const query = document.getElementById("search-input").value;

      // URL der zu crawlenden Webseite mit Suchparameter erstellen
      const url = `https://www.example.com/?q=${query}`;

      // Puppeteer initialisieren
      const puppeteer = await puppeteer.launch();

      // Neue Seite in Puppeteer öffnen
      const page = await puppeteer.newPage();

      // Zur Webseite navigieren
      try {
        await page.goto(url);
      } catch (error) {
        console.error(error);
        return;
      }

      // Titel der Webseite extrahieren
      const title = await page.title();

      // Alle Links auf der Webseite finden
      const links = await page.$$eval("a", (elements) => elements.map((element) => element.href));

      // Ergebnisse anzeigen
      showResults(title, links);

      // Puppeteer beenden
      await browser.close();
    }

    // Event-Listener für den Suchbutton
    document.getElementById("search-button").addEventListener("click", search);
  </script>
</body>
</html>
